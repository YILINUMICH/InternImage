# Waymo Evaluation Experiments Configuration

experiment_name: "waymo_dcnv3_evaluation"
dataset: "waymo"

# Dataset configuration
data:
  root: "evaluation_framework/data/waymo"
  split: "val"
  num_samples: null  # null = use all samples
  camera_names:
    - "FRONT"
    - "FRONT_LEFT"
    - "FRONT_RIGHT"
    - "SIDE_LEFT"
    - "SIDE_RIGHT"

# Models to evaluate
models:
  internimage_tiny:
    name: "InternImage-T"
    type: "internimage"
    backbone: "tiny"
    checkpoint: "evaluation_framework/models/pretrained/mask_rcnn_internimage_t_fpn_1x_coco.pth"
    config: "detection/configs/coco/mask_rcnn_internimage_t_fpn_1x_coco.py"
    
  internimage_small:
    name: "InternImage-S"
    type: "internimage"
    backbone: "small"
    checkpoint: "evaluation_framework/models/pretrained/mask_rcnn_internimage_s_fpn_1x_coco.pth"
    config: "detection/configs/coco/mask_rcnn_internimage_s_fpn_1x_coco.py"
  
  internimage_base:
    name: "InternImage-B"
    type: "internimage"
    backbone: "base"
    checkpoint: "evaluation_framework/models/pretrained/mask_rcnn_internimage_b_fpn_1x_coco.pth"
    config: "detection/configs/coco/mask_rcnn_internimage_b_fpn_1x_coco.py"
  
  # Baseline for comparison
  resnet50_baseline:
    name: "ResNet50-Baseline"
    type: "mask_rcnn"
    backbone: "resnet50"
    checkpoint: null  # Use default pretrained weights
    config: "detection/configs/mask_rcnn/mask_rcnn_r50_fpn_1x_coco.py"

# Evaluation settings
evaluation:
  batch_size: 1
  num_workers: 4
  gpu_ids: [0]
  
  # Metrics to compute
  metrics:
    - "mAP"
    - "AP50"
    - "AP75"
    - "AP_small"
    - "AP_medium"
    - "AP_large"
    - "AR"
  
  # Distance-based evaluation
  distance_bins:
    - [0, 30]      # Near
    - [30, 50]     # Medium
    - [50, 100]    # Far
    - [100, 200]   # Very far
  
  # Per-class evaluation (focus on safety-critical classes)
  classes_of_interest:
    - "pedestrian"
    - "cyclist"
    - "vehicle"
  
  # IoU thresholds
  iou_thresholds:
    - 0.5
    - 0.7
    - 0.9

# FPS benchmarking
fps_benchmark:
  enabled: true
  num_warmup_iterations: 10
  num_test_iterations: 100
  batch_sizes: [1, 2, 4]
  input_resolutions:
    - [800, 1280]
    - [960, 1600]
  target_fps: 30

# Pedestrian-specific analysis
pedestrian_analysis:
  enabled: true
  distance_bins:
    - [0, 10, "Critical"]
    - [10, 20, "Near"]
    - [20, 40, "Medium"]
    - [40, 80, "Far"]
    - [80, 200, "Very Far"]
  
  occlusion_levels:
    - "none"
    - "partial"
    - "heavy"
  
  miss_rate_threshold: 0.10  # 10% maximum acceptable miss rate

# Visualization settings
visualization:
  enabled: true
  max_samples: 50  # Number of samples to visualize
  save_predictions: true
  save_ground_truth: true
  output_format: "png"

# Output settings
output:
  results_dir: "evaluation_framework/results/waymo"
  plots_dir: "evaluation_framework/results/waymo/plots"
  logs_dir: "evaluation_framework/results/waymo/logs"
  save_predictions: true
  save_analysis: true

# Experiment tracking
tracking:
  enabled: true
  use_tensorboard: true
  log_interval: 10
